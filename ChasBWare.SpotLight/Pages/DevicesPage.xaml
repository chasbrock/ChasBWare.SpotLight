<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:tk="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:vm="clr-namespace:ChasBWare.SpotLight.Infrastructure.ViewModels;assembly=ChasBWare.SpotLight.Infrastructure"
             x:DataType="vm:DeviceListViewModel"
             x:Class="ChasBWare.SpotLight.Pages.DevicesPage"
             Title="DevicesPage"
             >

    <ContentPage.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
            <LinearGradientBrush.GradientStops>
                <GradientStop Offset="0.1" Color="LightSkyBlue" />
                <GradientStop Offset="1" Color="Lavender" />
            </LinearGradientBrush.GradientStops>
        </LinearGradientBrush>
    </ContentPage.Background>

    <ContentPage.Resources>

        <ResourceDictionary>
            <SolidColorBrush x:Key="ActiveBackground">DarkBlue</SolidColorBrush>
            <SolidColorBrush x:Key="InactiveBackground">Lavender</SolidColorBrush>
            <tk:BoolToObjectConverter x:Key="IsActiveBackground" 
               TrueObject="{StaticResource ActiveBackground}" 
               FalseObject="{StaticResource InactiveBackground}"/>
          
            <Color x:Key="ActiveForeground">White</Color>
            <Color x:Key="InactiveForeground">Black</Color>
            <tk:BoolToObjectConverter x:Key="IsActiveForeground" 
               TrueObject="{StaticResource ActiveForeground}" 
               FalseObject="{StaticResource InactiveForeground}"/>
        </ResourceDictionary>

    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,*" ColumnDefinitions="Auto,*">
        <ImageButton Source="icons8_refresh.png" HorizontalOptions="Start"
                     Command="{Binding RefreshCommand}" Grid.Row="0"/>
        <CollectionView ItemsSource="{Binding Devices}" Grid.Row="1"
                        SelectionMode="Single"
                        SelectedItem="{Binding SelectedDevice}"
                        Margin="8">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="vm:DeviceViewModel" >
                    <Border Margin="4" Style="{StaticResource RoundedBorder}" Padding="4">
                        <Grid ColumnDefinitions="Auto,*" Margin="2">
                            <Image Source="{Binding DeviceImage}" Grid.Column="0"/>
                            <Label Text="{Binding Name}" Grid.Column="1" Margin="8,0"
                               FontSize="Default" FontAttributes="Bold"
                               VerticalTextAlignment="Center"
                               Background="{Binding IsActive, Converter={StaticResource IsActiveBackground}}" 
                               TextColor="{Binding IsActive, Converter={StaticResource IsActiveForeground}}"/>
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>

</ContentPage>